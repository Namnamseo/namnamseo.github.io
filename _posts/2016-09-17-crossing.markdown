---
layout: post
title: 간단한 수학 문제
category: [math]
---

*[40th Putnam (1979)](https://mks.mff.cuni.cz/kalva/putnam/putn79.html)에 출제되었던 문제이다.*

## 평면상에, 어떠한 세 점도 한 직선 위에 있지 않은 점들이 $$2N$$개 있다. 그중 $$N$$개는 빨간색, $$N$$개는 파란색이다. 빨간색과 파란색 점을 matching시켜 $$N$$개의 선분을 긋는다. 이 선분들이 모두 서로 교차하지 않게 하는 것이 가능한가?

### 풀이 1

우선, $$k$$개의 빨간 점과 $$k$$개의 파란 점($$k \ge 2$$)이 있을 때, 이들을 두 그룹으로 나누어, 그 두 그룹이 **어떤 직선을 기준으로 분리**되어있고, 각 그룹 안에서 빨간 점과 파란 점의 갯수가 같게, 즉 한 그룹에는 빨간 점과 파란 점이 각각 $$t$$개, 다른 그룹에는 각각 $$(k-t)$$개가 되도록 나누는 방법이 있다고 생각해보자.  
이러한 방법이 있다면, 모든 그룹의 $$k = 1$$이 될 때까지 계속 점들을 그룹으로 나눈 뒤, 각각의 그룹의 빨간 점과 파란 점을 이어주면, 각각의 그룹은 공간적으로 분리되어 있으므로 항상 서로 교차하지 않게 나눌 수 있다.

이제 그렇게 나누는 방법을 생각해보자.  
convex hull 상의 어떤 점을 잡자. 일반성을 잃지 않고 빨간 점이라고 하자. (아니라면 모든 점의 색깔을 뒤집어버리면 된다)  
이 점에서 긴 팔을 뻗어서 다른 점들을 쭉 훑고 지나간다고 하자. 다음 그림과 같이.

![image](/img/2016-09-17-crossing.png)

어떤 값을 계산하는데, 초기값은 0이고, 파란색 점을 만나면 +1, 빨간색 점을 만나면 -1을 한다고 하자.  
위의 그림에서는 다음과 같을 것이다.

![image](/img/2016-09-17-crossing-graph.png)

세 점이 한 직선 위에 있는 경우가 없으므로 어떤 점들이 동시에 더해지는 일이 없다.  
가장 끝에는 항상 값이 1이어야 한다. (빨간 점 하나를 뺐기 때문에)

만약 가장 끝이 아닌데 값이 1인 곳이 나왔다면? 그 점을 포함하여 그룹을 분리하면 된다.  
위의 그래프에서는 이를테면 $$x=5$$에서 $$y=1$$이므로, 다섯 번째 점까지 포함하여 다음과 같이 자를 수 있다.

![image](/img/2016-09-17-crossing-group.png)

만약 가장 끝이 아닌 곳에서 모든 값이 1이 아니라면?  
그럼 처음 만나는 점은 무조건 빨간색이었을 것이다. 만약 파란색이었다면, 시작하자마자 +1이 되고, $$k \ge 2$$이므로 그곳은 끝점이 아니게 된다. 따라서 존재하게 된다.  
그러면 회전 순서를 바꾸어, 가장 마지막 점이 빨간색이 되도록 해보자.  
이 때도 총합이 1이어야 하므로, 마지막에는 2에서 1로 내려갔을 것이다.  
그런데 처음에는 0이었고, 어찌저찌 해서 2가 되었다는 뜻이므로, 중간에는 반드시 1을 거쳤을 것이다.  

따라서 양쪽 방향을 모두 보면 중간에 1이 존재하는 곳이 반드시 존재한다.  
그 방향으로 자르면, 항상 빨간색과 파란색의 점의 갯수가 같은 두 그룹으로 나눌 수 있다.  
수학적 귀납법을 통하여 항상 매칭이 가능함을 보일 수 있고, 특히 이 방법을 사용하면 실제 예 또한 구할 수 있다.

### 풀이 2

[출처](http://www.futilitycloset.com/2016/09/03/crossing-guard/).

교차하는지의 여부를 따지지 않고 임의로 선분을 이었다고 하자.  
어떤 매칭 $$M$$에 대해 $$S(M) = \sum \overline{A_{i}B_{i}}$$ 라고 하자.  
모든 $$N!$$개의 매칭 중, $$S(M)$$이 가장 작은 매칭이 존재할 것이다.  
그러한 매칭은 항상 **교차하지 않는다**. 이것의 증명은 어렵지 않다.  

만약 교차한다면, 그 교차를 다음 그림과 같이 **풀어줄 수 있다**.

![image](/img/2016-09-17-crossing-futilitycloset.png)

이 때, 삼각부등식에 의해 $$a+b>c, \, d+e>f$$이므로 $$S(M)$$이 감소한다.  
이는 $$S(M)$$이 최소인 매칭을 골랐다는 것에 모순이다.  
따라서 그러한 매칭은 항상 교차하지 않고, 역으로 항상 교차하지 않는 매칭이 (유한 개의 실수의 집합은 항상 minimum이 존재하므로) 존재한다.

이번 한국 정보올림피아드(33회 KOI 2016)의 중등부 4번 또한 비슷한 아이디어가 적용 가능하다.